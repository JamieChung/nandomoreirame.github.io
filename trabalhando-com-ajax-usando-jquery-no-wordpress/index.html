<!DOCTYPE html><html class="no-js" lang="pt-br" itemscope itemtype="http://schema.org/BlogPosting"><head><meta charset="utf-8"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="google-site-verification" content="zS1dSn20XtA4FJYEOQLXqI0boxZdMnJ2g3beje-cl20"><title> Trabalhando com Ajax usando jQuery no Wordpress | Fernando Moreira</title><meta name="description" content=" Trabalhar com ajax usando jQuery no Wordpress é muito fácil "><meta name="keywords" content="wordpress, jquery, php, ajax, programacao"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="theme-color" content="#005344"><meta itemprop="image" content=" http://nandomoreira.me/assets/images/banner.jpg "> <meta property="fb:admins" content="100003797913346"><meta property="fb:app_id" content="585852118228520"><meta property="og:type" content="article"><meta property="article:author" content="Fernando Moreira"><meta property="article:section" content="wordpress, jquery, php"><meta property="article:tag" content="wordpress, jquery, php, ajax, programacao"><meta property="article:published_time" content="2015-07-27 01:56:12 +0000"><meta property="og:url" content="http://nandomoreira.me/trabalhando-com-ajax-usando-jquery-no-wordpress"><meta property="og:title" content=" Trabalhando com Ajax usando jQuery no Wordpress | Fernando Moreira "><meta property="og:image" content=" http://nandomoreira.me/assets/images/banner.jpg "><meta property="og:description" content=" Trabalhar com ajax usando jQuery no Wordpress é muito fácil "><meta property="og:site_name" content="Fernando Moreira"><meta property="og:locale" content="pt_BR"> <meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@nandomoreirame"><meta name="twitter:title" content=" Trabalhando com Ajax usando jQuery no Wordpress | Fernando Moreira "><meta name="twitter:description" content=" Trabalhar com ajax usando jQuery no Wordpress é muito fácil "><meta name="twitter:image:src" content=" http://nandomoreira.me/assets/images/banner.jpg "> <meta itemprop="name" content=" Trabalhando com Ajax usando jQuery no Wordpress | Fernando Moreira "><meta itemprop="description" content=" Trabalhar com ajax usando jQuery no Wordpress é muito fácil "><meta itemprop="image" content=" http://nandomoreira.me/assets/images/banner.jpg "><link rel="apple-touch-icon" sizes="57x57" href="/assets/images/ico/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/images/ico/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/images/ico/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/images/ico/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/images/ico/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/images/ico/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/images/ico/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/images/ico/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/images/ico/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/images/ico/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/images/ico/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/images/ico/favicon-16x16.png"><link rel="shortcut icon" href="/assets/images/ico/favicon-16x16.png"><link rel="manifest" href="/assets/images/ico/manifest.jso"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/images/ico/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/assets/main-d8a7a95d8c85ad1b7d681adc893d7aad.css"> <script src="/assets/modernizr-custom-f107b7598612dd5dee41b91ec615408f.js" data-cfasync="false"></script><link rel="canonical" href="http://nandomoreira.me/trabalhando-com-ajax-usando-jquery-no-wordpress"><link rel="alternate" type="application/rss+xml" title="Fernando Moreira" href="http://nandomoreira.me/feed.xml"> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Website", "publisher": "nandomoreira.me", "url": "http://nandomoreira.me/", "description": "Desenvolvedor Front-end, Design Responsivo, HTML5, CSS3 e JavaScript" } </script> <script type="text/javascript"> var disqus_shortname = 'fernandomoreira'; var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-52446115-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script><body class="post-template single"><header class="header"> <a href="/"> <img src="/assets/images/author.jpg" alt="author thumb" class="dot author-thumb"> </a><h1 itemscope itemtype="http://schema.org/Person">Olá meu nome é <strong itemprop="name">Fernando Moreira</strong> eu sou <em itemprop="jobTitle">Front-end</em> e gosto muito de café!</h1><nav class="nav"><ul class="navbar"><li><a href="/blog" class="subnav-trigger"><span>Artigos</span></a><li><a href="/about">Sobre</a><li class="search"> <a href="#!" data-modal-search="modalSearch"><i class="fa fa-search"></i> Busca</a></ul></nav></header><main class="wrapper" itemprop="mainContentOfPage"><article role="article" class="post" itemprop="articleBody"><div class="container"><header class="post-header"><h1 class="post-title">Trabalhando com Ajax usando jQuery no Wordpress</h1><div class="post-meta"> <time datetime="2015-07-27T01:56:12+00:00" itemprop="datePublished"><meta itemprop="datePublished" content="2015-07-27T01:56:12+00:00"> <i class="fa fa-calendar-o"></i> 27/7/2015 </time> <span> | <i class="fa fa-comments"></i> <a href="/trabalhando-com-ajax-usando-jquery-no-wordpress#disqus_thread" data-disqus-identifier="/trabalhando-com-ajax-no-wordpress">Deixe um comentário</a> </span> <span> | <i class="fa fa-folder-open-o"></i> <a href="/categoria/wordpress/">Wordpress</a>, <a href="/categoria/jquery/">jQuery</a>, <a href="/categoria/php/">PHP</a> </span></div></header><div class="post-content"><p>Trabalhar com ajax usando <a href="http://www.jquery.com">jQuery</a> no <a href="http://br.wordpress.org">Wordpress</a> é muito fácil, hoje vou explicar com apenas algumas linhas de código um exemplo simplificado de como fazer essa grande façanha.<h4 id="script-footer">Script footer</h4><p>A primeira coisa que você deve fazer é incluir o <code>admin-ajax.php</code> no seu tema.. usaremos a função <code>wp_enqueue_script()</code> do wordpress para isso, e usando <code>add_action()</code> incluiremos nossos scripts na lista de scripts a serem chamadas pela função <code>wp_footer()</code> no final do nosso tema.<p><strong>Fica mais ou menos assim:</strong><div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="cm">/*</span>
<span class="cm"> *  add Footer scripts</span>
<span class="cm"> */</span>
<span class="k">function</span> <span class="nf">footer_scripts</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">wp_enqueue_script</span><span class="p">(</span> <span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="nx">get_stylesheet_directory_uri</span><span class="p">()</span> <span class="o">.</span> <span class="s1">&#39;/js/main.js&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="k">null</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>
  <span class="nx">wp_localize_script</span><span class="p">(</span> <span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="s1">&#39;wpAjax&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;ajaxurl&#39;</span><span class="o">=&gt;</span><span class="nx">admin_url</span><span class="p">(</span><span class="s1">&#39;admin-ajax.php&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
<span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;wp_enqueue_scripts&#39;</span><span class="p">,</span> <span class="s1">&#39;footer_scripts&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div><p>Após inserir essas linhas de código no seu arquivo <code>functions.php</code> vamos ver como ficou nosso site no navegador.. nada mudou certo? Aparentemente não, mas vamos visualizar o código fonte.<p><a href="/assets/images/posts/2015/07/trabalhando-com-ajax-usando-jquery-no-wordpress-scripts-footer.png" class="swipebox" rel="gallery" title="Trabalhando com Ajax usando jQuery no Wordpress"> <img src="/assets/images/posts/2015/07/trabalhando-com-ajax-usando-jquery-no-wordpress-scripts-footer.png" alt="Trabalhando com Ajax usando jQuery no Wordpress" /> </a><h4 id="o-javascript">O JavaScript</h4><p>Note que junto com o <code>admin-ajax.php</code> nós incluimos também um arquivo chamado <code>main.js</code>, nesse arquivo vamos adicionar nosso jQuery ajax para chamar nossa função PHP.<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.mypost&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">post_id</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span>
        <span class="nx">$postContent</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#post-&quot;</span> <span class="o">+</span> <span class="nx">post_id</span><span class="p">);</span>
    <span class="nx">$postContent</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">&#39;action&#39;</span>  <span class="o">:</span> <span class="s1">&#39;PostAjaxme&#39;</span><span class="p">,</span>
      <span class="s1">&#39;post-id&#39;</span> <span class="o">:</span> <span class="nx">post_id</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">url</span>      <span class="o">:</span> <span class="nx">wpAjax</span><span class="p">.</span><span class="nx">ajaxurl</span><span class="p">,</span>
      <span class="nx">data</span>     <span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
      <span class="nx">method</span>   <span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
      <span class="nx">dataType</span> <span class="o">:</span> <span class="s1">&#39;json&#39;</span>
    <span class="p">});</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;div class=&quot;entry-content&quot;&gt;&#39;</span><span class="o">+</span><span class="nx">r</span><span class="p">.</span><span class="nx">html</span><span class="o">+</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
      <span class="nx">$postContent</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">html</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span></code></pre></div><p>Ao clicar na classe <code>.mypost</code> o método <code>on()</code> do jQuery vai disparar um click para uma função, nessa função vamos pegar o ID do post que estará em um atributo chamado <code>data-id</code> no nosso HTML.<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">&lt;article id=&quot;post-</span><span class="cp">&lt;?php</span> <span class="nx">the_ID</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x">&quot; </span><span class="cp">&lt;?php</span> <span class="nx">post_class</span><span class="p">(</span><span class="s1">&#39;mypost&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"> data-id=&quot;</span><span class="cp">&lt;?php</span> <span class="nx">the_id</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span></code></pre></div><p>Ainda no jQuery nós precisamos saber onde vamos incluir o retorno de nosso PHP, então eu vou colocar dentro do próprio post, com a variável <code>$postContent</code>, limpando o que já existia nesse container.<p>A variável <code>data</code> é o objeto que será passado para o método <code>$.ajax</code> do jQuery, nesse mesmo método estamos passando mais alguns paramentros como a url do nosso arquivo <code>admin-ajax.php</code>, o tipo de metodo como <code>POST</code> e o dataType como <code>json</code>.<p>Com tudo isso configurado no callback <code>.success()</code> trataremos de exibir o resultado do nosso ajax, colocando esse resultado dentro do nosso container criado logo acima.<h4 id="nosso-php">Nosso PHP</h4><p>No javascript nós passamos uma variável <code>action</code> com valor <code>PostAjaxme</code>, certo? Pois bem.. usaremos esse valor dessa variável em nosso PHP, passando ele como parametro na função <code>add_action()</code> do Wordpress, veja como. <?php add_action( 'wp_ajax_PostAjaxme', 'SUCA_FUNCAO_AQUI' ); add_action( 'wp_ajax_nopriv_PostAjaxme', 'SUCA_FUNCAO_AQUI' ); ?><p>Note que nossa action ficou concatenada com <code>wp_ajax_</code> e <code>wp_ajax_nopriv_</code>, é assim que o Wordpress faz a ligação do seu JavaScript com a sua função PHP.<p>Se você quiser criar seu ajax apenas para o painel administratido do Wordpress basta usar apenas o <code>wp_ajax_</code> para tal, mas se você quiser usar no front do seu tema você precisa usar o <code>wp_ajax_nopriv_</code> juntamente com o <code>wp_ajax_</code>.<h4 id="a-funo-do-php">A função do PHP</h4><p>Feito isso vamos criar nossa função e chamar elas dentro das funções <code>add_action()</code> do WP. Fica mais ou menos assim:<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">PostAjaxme_callback</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
<span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;wp_ajax_PostAjaxme&#39;</span><span class="p">,</span> <span class="s1">&#39;PostAjaxme_callback&#39;</span> <span class="p">);</span>
<span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;wp_ajax_nopriv_PostAjaxme&#39;</span><span class="p">,</span> <span class="s1">&#39;PostAjaxme_callback&#39;</span> <span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div><p>Ai é só usar a criatividade de um programador nato e “botar pra quebrar!”. No meu exemplo eu fiz o retorno de uma simples mensagem em HTML.<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">PostAjaxme_callback</span><span class="p">()</span> <span class="p">{</span>
  <span class="nv">$return_array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$post_ID</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;post-id&#39;</span><span class="p">]);</span>
  <span class="nv">$return_array</span><span class="p">[</span><span class="s1">&#39;html&#39;</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39;&lt;p&gt;&#39;</span><span class="p">;</span>
  <span class="nv">$return_array</span><span class="p">[</span><span class="s1">&#39;html&#39;</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39;Olá eu ou a requisição &lt;b&gt;Ajax&lt;/b&gt; que você acabou de chamar!&#39;</span><span class="p">;</span>
  <span class="nv">$return_array</span><span class="p">[</span><span class="s1">&#39;html&#39;</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39;O meu ID é: &lt;b&gt;&#39;</span><span class="o">.</span><span class="nv">$post_ID</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;&#39;</span><span class="p">;</span>
  <span class="nv">$return_array</span><span class="p">[</span><span class="s1">&#39;html&#39;</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39;&lt;/p&gt;&#39;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$return_array</span><span class="p">);</span>
  <span class="nx">wp_die</span><span class="p">();</span>
<span class="p">}</span>
<span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;wp_ajax_PostAjaxme&#39;</span><span class="p">,</span> <span class="s1">&#39;PostAjaxme_callback&#39;</span> <span class="p">);</span>
<span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;wp_ajax_nopriv_PostAjaxme&#39;</span><span class="p">,</span> <span class="s1">&#39;PostAjaxme_callback&#39;</span> <span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div><p><img src="/assets/images/posts/2015/07/trabalhando-com-ajax-usando-jquery-no-wordpress-video-gif.gif" alt="Trabalhando com Ajax usando jQuery no Wordpress Video gif" /><h3 id="concluso">Conclusão</h3><p>É muito útil e relativamente simples trabalhar com Ajax no Wordpress, se você quiser baixar os exemplos estarão no meu <a href="https://github.com/nandomoreirame/Trabalhando-com-Ajax-usando-jQuery-no-Wordpress">Github</a> para <a href="https://github.com/nandomoreirame/Trabalhando-com-Ajax-usando-jQuery-no-Wordpress/archive/master.zip">download</a>.<p>As funções são exemplos meramente ilustrativos e podem ser alteradas como você bem entender, como eu disse o Céu é o limite, use e abuse da sua criatividade como programador e divirta-se!<p>Esse é o post de hoje. Abraços!</div></div><footer class="post-footer"><div class="container"><section class="author"> <img src="/assets/images/author.jpg" alt="author thumb" class="dot author-thumb"><h4>Fernando Moreira</h4><p>Desenvolvedor Front-end entusiasta de performance, design responsivo e usabilidade, sempre em busca do melhor projeto e de um bom café.</section><aside class="share"><h4>Compartilhe.</h4><a class="share-twitter" href="http://twitter.com/share?text=Trabalhando com Ajax usando jQuery no Wordpress&amp;url=http://nandomoreira.me/trabalhando-com-ajax-usando-jquery-no-wordpress&amp;hashtags=web,dev,blog,soudev&amp;via=nandomoreirame" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"> <i class="fa fa-twitter-square"></i> </a> <a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://nandomoreira.me/trabalhando-com-ajax-usando-jquery-no-wordpress" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"> <i class="fa fa-facebook-square"></i> </a></aside></div></footer><aside id="comments" class="disqus"><div class="container-full"><h3><i class="fa fa-comments"></i> Comentários</h3><hr><div id="disqus_thread"></div><script type="text/javascript"> var disqus_identifier = '/trabalhando-com-ajax-no-wordpress'; var disqus_title = 'Trabalhando com Ajax usando jQuery no Wordpress'; var disqus_url = 'http://nandomoreira.me'; /*var disqus_developer = 1;*/ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a> </noscript></div></aside></article></main><footer class="footer"><ul class="social"><li> <a href="http://github.com/nandomoreirame" class="icon-github" target="_blank"> <i class="fa fa-github"></i> </a><li> <a href="http://twitter.com/nandomoreirame" class="icon-twitter" target="_blank"> <i class="fa fa-twitter"></i> </a><li> <a href="http://linkedin.com/in/nandomoreirame" class="icon-linkedin" target="_blank"> <i class="fa fa-linkedin"></i> </a><li> <a href="/feed.xml" target="_blank"><i class="fa fa-feed"></i></a></ul><span> Feito com <a href="http://jekyllrb.com" target="_blank">Jekyll</a> • <a href="http://github.com/nandomoreirame/nandomoreirame.github.io" target="_blank">Open source <i class="fa fa-heart"></i></a> </span></footer><a class="scroll-up fa fa-chevron-up bounce" href="#" data-position="0"></a><div id="modalSearch" class="modal-search"><div class="modal-search__overlay"></div><div class="modal-search__content"> <a href="#!" class="modal-search-close" data-modal-close>&times;</a><div class="modal-search-container"> <input type="text" id="modal-search-input" placeholder="#"><ul id="search-results-container"></ul></div></div></div><script src="/assets/main-9ac95fd192ff9afb27abc7e0e70d5f91.js"></script>
